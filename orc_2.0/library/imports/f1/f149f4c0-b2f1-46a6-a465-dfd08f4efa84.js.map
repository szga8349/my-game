{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\Home/assets\\Script\\Home\\Home.js"],"names":["Global","require","utils","cc","Class","extends","Component","properties","moneyLabel","default","type","Label","skilBox","Node","explain","shopBox","Prefab","signInBox","audioBgm","AudioClip","removeData","window","localStorage","clear","director","loadScene","checkSign","now","timeFormat","split","last","userInfo","signDate","box","instantiate","y","x","parent","node","skilBtn","e","num","Number","dash","switchSkillBox","switchShop","gameInfo","startDash","saveData","boom","orcBoom","fanatical","crazy","total","show","skillMove","action","moveTo","height","easing","easeExponentialOut","seq","sequence","callFunc","runAction","shopMove","shop","switchExplain","explainMove","width","updateUserInfo","string","money","find","getComponent","openGame","playBgm","openRank","onLoad","home","fetchData","preloadScene","console","log","audioEngine","playMusic","start","wx","getUserInfo","success","res","fail","_w","getSystemInfoSync","windowWidth","_h","windowHeight","warn","loginBtn","createUserInfoButton","text","style","left","top","lineHeight","backgroundColor","color","textAlign","fontSize","borderRadius","onTap","errMsg","destroy","showShareMenu","onShareAppMessage","title","shareInfo","imageUrl","url"],"mappings":"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","file":"Home.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Home","sourcesContent":["const Global = require('Global');\r\nconst utils = require('utils');\r\n\r\n// console.log(CusBASE64.encoder);\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 金币\r\n        moneyLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        // 技能选择\r\n        skilBox: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // 说明\r\n        explain: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // 商店\r\n        shopBox: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        // 签到资源\r\n        signInBox: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        // bgm\r\n        audioBgm: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n    removeData() {\r\n        window.localStorage.clear();\r\n        cc.director.loadScene('Home');\r\n    },\r\n    // 检查是否可以签到\r\n    checkSign() {\r\n        let now = utils.timeFormat().split(' ')[0];\r\n        let last = Global.userInfo.signDate.split(' ')[0];\r\n        // console.log(now, last);\r\n        if (now != last) {\r\n            let box = cc.instantiate(this.signInBox);\r\n            box.y = box.x = 0;\r\n            box.parent = this.node;\r\n        } \r\n    },\r\n    // 技能按钮\r\n    skilBtn(e, num) {\r\n        switch (Number(num)) {\r\n            case 1:\r\n                if (Global.userInfo.dash == 0) {\r\n                    this.switchSkillBox();\r\n                    this.switchShop(null, 'show');\r\n                } else {\r\n                    Global.userInfo.dash -= 1;\r\n                    Global.gameInfo.startDash = true;\r\n                    Global.saveData();\r\n                    cc.director.loadScene('Game');\r\n                }\r\n                break;\r\n            case 2:\r\n                if (Global.userInfo.boom == 0) {\r\n                    this.switchSkillBox();\r\n                    this.switchShop(null, 'show');\r\n                } else {\r\n                    Global.userInfo.boom -= 1;\r\n                    Global.saveData();\r\n                    Global.gameInfo.orcBoom = 3;\r\n                    cc.director.loadScene('Game');\r\n                }\r\n                break;\r\n            case 3:\r\n                if (Global.userInfo.fanatical == 0) {\r\n                    this.switchSkillBox();\r\n                    this.switchShop(null, 'show');\r\n                } else {\r\n                    Global.userInfo.fanatical -= 1;\r\n                    Global.saveData();\r\n                    Global.gameInfo.crazy = 2;\r\n                    Global.gameInfo.total = 18;\r\n                    cc.director.loadScene('Game');\r\n                }\r\n                break;\r\n        }\r\n    },\r\n    // 技能选择切换\r\n    switchSkillBox(e, show = null) {\r\n        if (this.skillMove) return;\r\n        this.skillMove = true;\r\n        let action = null;\r\n        if (show) {\r\n            action = cc.moveTo(0.5, 0, 0);\r\n        } else {\r\n            action = cc.moveTo(0.5, 0, -this.node.height);\r\n        }\r\n        action.easing(cc.easeExponentialOut(3.0));\r\n        let seq = cc.sequence(action, cc.callFunc(() => {\r\n            this.skillMove = false;\r\n        }));\r\n        this.skilBox.runAction(seq);\r\n    },\r\n    // 商店切换\r\n    switchShop(e, show = null) {\r\n        if (this.shopMove) return;\r\n        this.shopMove = true;\r\n        let action = null;\r\n        if (show) {\r\n            action = cc.moveTo(0.5, 0, 0);\r\n        } else {\r\n            action = cc.moveTo(0.5, 0, this.node.height);\r\n        }\r\n        action.easing(cc.easeExponentialOut(3.0));\r\n        let seq = cc.sequence(action, cc.callFunc(() => {\r\n            this.shopMove = false;\r\n        }));\r\n        this.shop.runAction(seq);\r\n    },\r\n    // 说明切换\r\n    switchExplain(e, show = null) {\r\n        if (this.explainMove) return;\r\n        this.explainMove = true;\r\n        let action = null;\r\n        let seq = null;\r\n        if (show) {\r\n            action = cc.moveTo(0.5, 0, 0);\r\n            action.easing(cc.easeExponentialOut(3.0));\r\n        } else {\r\n            action = cc.moveTo(0.5, -this.node.width, 0);\r\n            action.easing(cc.easeExponentialOut(3.0));\r\n        }\r\n        seq = cc.sequence(action, cc.callFunc(() => {\r\n            this.explainMove = false;\r\n        }));\r\n        this.explain.runAction(seq);\r\n    },\r\n    // 更新用户数据\r\n    updateUserInfo() {\r\n        // 修改金币\r\n        this.moneyLabel.string = Global.userInfo.money;\r\n        cc.find('money/text', this.shop).getComponent(cc.Label).string = Global.userInfo.money;\r\n        \r\n        cc.find('skill-1/content', this.skilBox).getComponent(cc.Label).string = '高能陨石 ×' + Global.userInfo.dash;\r\n        cc.find('skill-2/content', this.skilBox).getComponent(cc.Label).string = '炸弹多多 ×' + Global.userInfo.boom;\r\n        cc.find('skill-3/content', this.skilBox).getComponent(cc.Label).string = '兽人狂暴 ×' + Global.userInfo.fanatical;\r\n\r\n        if (Global.userInfo.dash == 0) {\r\n            cc.find('skill-1/btn/text', this.skilBox).getComponent(cc.Label).string = '去购买';\r\n        } else{\r\n            cc.find('skill-1/btn/text', this.skilBox).getComponent(cc.Label).string = '使用';\r\n        } \r\n        if (Global.userInfo.boom == 0) {\r\n            cc.find('skill-2/btn/text', this.skilBox).getComponent(cc.Label).string = '去购买';\r\n        } else {\r\n            cc.find('skill-2/btn/text', this.skilBox).getComponent(cc.Label).string = '使用';\r\n        }\r\n        \r\n        if (Global.userInfo.fanatical == 0) {\r\n            cc.find('skill-3/btn/text', this.skilBox).getComponent(cc.Label).string = '去购买';\r\n        } else {\r\n            cc.find('skill-3/btn/text', this.skilBox).getComponent(cc.Label).string = '使用';\r\n        }\r\n        \r\n    },\r\n    openGame() {\r\n        Global.playBgm = true;\r\n        cc.director.loadScene('Game');\r\n    },\r\n    openRank() {\r\n        Global.playBgm = true;\r\n        cc.director.loadScene('Rank');\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        Global.home = this;\r\n        // 获取本地数据\r\n        if (Global.fetchData()) Global.userInfo = Global.fetchData();\r\n        \r\n        // 输出商店\r\n        this.shop = cc.instantiate(this.shopBox);\r\n        this.shop.parent = this.node;\r\n\r\n        // 重置位置\r\n        this.shop.y = this.node.height;\r\n        this.skilBox.y = -this.node.height;\r\n        this.explain.width = this.node.width;\r\n        this.explain.height = this.node.height;\r\n        this.explain.x = -this.node.width;\r\n\r\n        // 更新数据\r\n        this.updateUserInfo();\r\n\r\n        // 检测签到\r\n        this.checkSign();\r\n\r\n        cc.director.preloadScene('Game', () => console.log('预加载游戏场景成功'));\r\n        // 背景音乐\r\n        if (!Global.playBgm) {\r\n            cc.audioEngine.playMusic(this.audioBgm, true);\r\n        }\r\n    },\r\n\r\n    start() {\r\n        if (window.wx) {\r\n            // 检测用户是否授权过\r\n            wx.getUserInfo({\r\n                success(res) {\r\n                    console.log('用户授权信息====>', res);\r\n                },\r\n                fail() {\r\n                    let _w = wx.getSystemInfoSync().windowWidth,\r\n                        _h = wx.getSystemInfoSync().windowHeight;\r\n                    console.warn('创建获取用户信息按钮');\r\n                    // 创建获取用户信息按钮\r\n                    let loginBtn = wx.createUserInfoButton({\r\n                        type: 'text',\r\n                        text: '',\r\n                        style: {\r\n                            left: 0,\r\n                            top: 0,\r\n                            width: _w,\r\n                            height: _h,\r\n                            lineHeight: _h,\r\n                            backgroundColor: 'rgba(0, 0, 0, 0)',\r\n                            color: 'rgba(0, 0, 0, 0)',\r\n                            textAlign: 'center',\r\n                            fontSize: 16,\r\n                            borderRadius: 4\r\n                        }\r\n                    });\r\n                    // 监听点击事件\r\n                    loginBtn.onTap(res => {\r\n                        console.log('用户授权数据：', res);\r\n                        if (res.errMsg != 'getUserInfo:ok') return;\r\n                        loginBtn.destroy();\r\n                    });\r\n                }\r\n            });\r\n            // 显示分享按钮\r\n            wx.showShareMenu();\r\n            // 设置转发分内容\r\n            wx.onShareAppMessage(res => {\r\n                return {\r\n                    title: Global.shareInfo.title,\r\n                    imageUrl: Global.shareInfo.url,\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}